More functions and More nested loop
